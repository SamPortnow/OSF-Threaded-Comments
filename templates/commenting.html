<!DOCTYPE html>
<html>
<head>
    <title>Bootstrap 101 Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="../static/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <style>
        body
        {
            padding:10px;
        }
        .container-fluid
        {
            border-left-style: dashed;
        }
    </style>
</head>
<body>
    <p>
    <form action="/" method="post" class="add-entry">
        <textarea rows="3" name=comment>
        </textarea>
    </p>
    <p><button class="btn-primary" type="submit">Comment</button>
    </p>
    </form>
    {% set count = 0 %}
    {% set what = 0 %}

    <div class="comment-group">
    {% for comment in comment_groups  %}

        {% if comment.first %} <div class="comment-group"> {% endif %}
        <div class="container-fluid offset{{comment.indentation}}">

                <div class="row-fluid">
                    <div class="span4 offset{{comment.indentation}}" id="text-{{count}}" data-id="{{comment._id}}">
                        {{comment.text}}
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span1 offset{{comment.indentation}}"
                         id="comment-{{count}}">
                        <button class="btn-primary" id="btn-{{count}}"
                                onclick="AddReplyBox('{{count}}', '{{comment.indentation+1}}')">Reply</button>
                    </div>
                </div>

            {% if comment.first %} </div> {% endif %}

    {% endfor %}
    </div>
    <!--&lt;!&ndash;-->
    <!--{% for comment in comments %}-->
    <!--&lt;!&ndash;{% if comment.reset != True %}&ndash;&gt;-->
    <!--&lt;!&ndash;<div class="container-fluid offset{{comment.indentation}}">&ndash;&gt;-->
    <!--&lt;!&ndash;{% endif %}&ndash;&gt;-->
    <!--<div class="container-fluid offset{{comment.indentation}}">-->

    <!--<div class="row-fluid">-->
        <!--<div class="span4 offset{{comment.indentation}}" id="text-{{count}}" data-id="{{comment._id}}">-->
            <!--{{comment.text}}-->
        <!--</div>-->
    <!--</div>-->
    <!--<div class="row-fluid">-->
        <!--<div class="span1 offset{{comment.indentation}}"-->
         <!--id="comment-{{count}}">-->
        <!--<button class="btn-primary" id="btn-{{count}}"-->
                <!--onclick="AddReplyBox('{{count}}', '{{comment.indentation+1}}')">Reply</button>-->
        <!--</div>-->
    <!--</div>-->
    <!--{% if comment.last == True %}-->
        <!--</div>-->
    <!--{% endif %}-->
    <!--{% set divs = divs + 1 %}-->
    <!--{% set count = count + 1 %}-->
    <!--{% if comment.reset == True %}-->
        <!--{% for number in range(0,divs) %}-->
        <!--</div>-->
        <!--{% endfor %}-->
        <!--{% set divs = 1 %}-->
    <!--{% endif %}-->
    <!--{% endfor %}-->

<script src="../static/bootstrap/js/bootstrap.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script>
    function AddReplyBox(count, indentation)
    {
        var parent_id = document.getElementById('text-'+count)
            .getAttribute('data-id');

        $('#btn-'+count).remove();
        $('#comment-'+count).append(
                "<form action='/' method='post' class='add-entry'>" +
                "<textarea rows='3' name=comment></textarea>" +
                "<input type='hidden' name='parent' value='" + parent_id +"'>"+
                "<input type='hidden' name='indent' value='" + indentation + "'>"+
                "<p><button class='btn-primary' type='submit'> Reply</button></p></form>");
    };
</script>
</body>
</html>